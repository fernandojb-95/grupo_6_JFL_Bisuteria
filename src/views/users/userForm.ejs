<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../partials/head') %>
    <title>Editando</title>
    <link rel="stylesheet" href="/css/userForm.css">
</head>
<body>
    <%- include('../partials/header') %>
    <main>
        <h1>Editando información de usuario</h1>

        <form class="updating-form" action="/user/edit/<%=user.id%>?_method=PATCH" method="POST" enctype="multipart/form-data">
            <div class="tec-inputs">
                <div class="input-section">
                    <label for="name">Nombre:</label>
                    <input type="text" name="user" class="user-input" value="<%=user.first_name%>">
                    <%if (locals.errors) { %>
                        <% errors.forEach(error => {%>
                            <% if(error.param == 'user') { %>
                            <p class="register-errors"> <%=error.msg %></p>
                            <% } %>
                        <%})%>
                    <% }%>
                </div>
                <div class="input-section">
                    <label for="name">Apelllido: </label>
                    <input type="text" name="lastname" class="last-name-input" value="<%=user.last_name%>">
                    <%if (locals.errors) { %>
                        <% errors.forEach(error => {%>
                            <% if(error.param == 'lastname') { %>
                            <p class="register-errors"> <%=error.msg %></p>
                            <% } %>
                        <%})%>
                    <% }%>
                </div>
                <div class="input-section">
                    <label for="name">Email: </label>
                    <input type="email" name="email" class="email-input" value="<%=user.email%>">
                    <%if (locals.errors) { %>
                        <% errors.forEach(error => {%>
                            <% if(error.param == 'email') { %>
                            <p class="register-errors"> <%=typeof error.msg === "object" ? error.msg.msg : error.msg %></p>
                            <% } %>
                        <%})%>
                    <% }%>
                </div>
                <div class="input-section">
                    <label for="name">Nueva contraseña: </label>
                    <input type="password" name="password" class="pass-input">
                    <%if (locals.errors) { %>
                        <% errors.forEach(error => {%>
                            <% if(error.param == 'password') { %>
                            <p class="register-errors"> <%=error.msg %></p>
                            <% } %>
                        <%})%>
                    <% }%>
                </div>
                <div class="input-section">
                    <label for="name">Confirma la nueva contraseña:</label>
                    <input type="password" name="passwordConfirm" class="pass-confirm-input">
                    <%if (locals.errors) { %>
                        <% errors.forEach(error => {%>
                            <% if(error.param == 'passwordConfirm') { %>
                            <p class="register-errors"> <%=error.msg %></p>
                            <% } %>
                        <%})%>
                    <% }%>
                    <p class="label">La contraseña debe contener al menos 8 caracteres, una mayúscula, una minúscula y un número</p>
                </div>
                <div class="input-section">
                    <div class="img-preview">
                        <button id="delete" class="delete"><i class="far fa-times-circle"></i></button>
                    </div>
                    <label for="imagenUsuario" >Imagen de perfil: </label>
                    <input type="file" name="imagenUsuario" id="file">
                    <div class="delete-photo">
                        <input type="checkbox" name="delete" id="deletePhoto">
                        <label for="deletePhoto">Eliminar foto de perfil</label>
                    </div>
                </div>
            </div>
            <div class="checkitems">
                <div>
                    <button class="button"><a href="/user/<%=user.id%>/profile">Regresar</a></button>
                    <button type="submit" name="update" class="button">Aceptar</button>
                </div>
            </div> 
        </form>
    </main>
    <%- include('../partials/footer') %>
    <script src="/js/userForm.js"></script>
</body>
</html>